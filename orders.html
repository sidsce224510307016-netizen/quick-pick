<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Kitchen Orders | Rialto</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Inter', sans-serif;
  background: #111827;
}

.status-preparing {
  color: #facc15;
}

.status-ready {
  color: #22c55e;
}
</style>
</head>

<body class="text-white p-6">

<h1 class="text-3xl font-bold mb-6">üçΩÔ∏è Kitchen Orders</h1>

<div id="ordersContainer" class="space-y-4">
  <p class="text-gray-400">Loading orders...</p>
</div>

<script>
async function loadOrders() {
  try {
    const res = await fetch("/orders");
    const orders = await res.json();

    const container = document.getElementById("ordersContainer");
    container.innerHTML = "";

    if (orders.length === 0) {
      container.innerHTML = "<p class='text-gray-400'>No active orders.</p>";
      return;
    }

    orders.forEach(order => {
      const div = document.createElement("div");
      div.className = "bg-gray-900 p-5 rounded-xl shadow";

      div.innerHTML = `
        <div class="flex justify-between">
          <div>
            <h2 class="text-xl font-semibold">${order.name || "Guest"}</h2>
            <p class="text-sm text-gray-400">
              Items: ${order.itemCount || order.items.length}
            </p>
            <p class="text-sm text-gray-400">
              Prep Time: ${order.prepTime || "‚Äî"} min
            </p>
          </div>

          <div class="text-right">
            <span class="text-sm ${
              order.status === "Ready for Pickup" 
                ? "status-ready" 
                : "status-preparing"
            }">
              ${order.status || "Preparing"}
            </span>
          </div>
        </div>

        <ul class="mt-3 list-disc list-inside text-gray-300">
          ${
            Array.isArray(order.items)
              ? order.items.map(i => `<li>${i.name || i}</li>`).join("")
              : `<li>${order.items}</li>`
          }
        </ul>
      `;

      container.appendChild(div);
    });

  } catch (err) {
    console.error(err);
  }
}

// refresh every 5 seconds
loadOrders();
setInterval(loadOrders, 5000);
</script>

</body>
</html>
